<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>éšæœºåå­—æŠ½å¥–ç³»ç»Ÿï¼ˆæ— é‡å¤ï¼‰</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            text-align: center;
            margin: 50px;
            background-color: #f4f7f9;
            color: #333;
        }
        h1 {
            color: #4a90e2;
            font-size: 2.5em;
            margin-bottom: 20px;
        }
        p {
            font-size: 1.1em;
            margin-bottom: 30px;
            color: #555;
        }
        #display {
            font-size: 48px;
            font-weight: bold;
            color: #e94e77;
            margin: 50px 0;
            height: 60px;
            line-height: 60px;
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
            padding: 20px;
            width: 300px;
            margin: 0 auto 30px;
            transition: color 0.3s;
        }
        button {
            padding: 12px 30px;
            font-size: 18px;
            background-color: #4a90e2;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.2s;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            margin: 10px;
        }
        button:hover {
            background-color: #357abd;
            transform: translateY(-2px);
        }
        button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }
        #result {
            margin-top: 30px;
            font-size: 28px;
            color: #28a745;
            font-weight: bold;
            animation: fadeIn 1s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
    </style>
</head>
<body>
    <h1>éšæœºåå­—æŠ½å¥–ç³»ç»Ÿï¼ˆæ— é‡å¤ï¼‰</h1>
    <p>ç‚¹å‡»å¼€å§‹ï¼Œåå­—ä¼šå¿«é€Ÿéšæœºåˆ‡æ¢ï¼Œç„¶åé€æ¸æ…¢ä¸‹æ¥åœåœ¨å¹¸è¿å„¿ä¸Šã€‚æŠ½ä¸­åç§»é™¤ï¼Œä¸ä¼šé‡å¤ã€‚</p>
    <button id="startButton" onclick="startLottery()">å¼€å§‹æŠ½å¥–</button>
    <button id="resetButton" onclick="resetLottery()">é‡ç½®</button>
    <div id="display">å‡†å¤‡ä¸­...</div>
    <div id="result"></div>

    <script>
        let isRunning = false;
        const builtinNames = [
            'æ¬§è¯ºç„°', 'ç‹ä»™å', 'é»„å®—æ¯…', 'é™ˆæ²»å¦', 'è°¢æ²›ä¸š', 'é™ˆå®¶æ¶›', 'é™ˆå­¦æˆ', 'æ—å®—æ³½', 'æ±Ÿèµæ´‹', 'æ¢ä¸€èŠ¯',
            'é»„æ¬£å„¿', 'ä½™åº”å³»', 'é»æ•ç²', 'é™ˆå®¶ä¿Š', 'é‚µæ³½æ»”', 'é’Ÿæœ‰æ‰¬', 'æœ±æ´›è½©', 'è‘£æå®—', 'è“æµ·å¹³',
            'é™ˆé’°å©§', 'æ¬§å¿ƒæ€¡', 'ææ–¹æ™‹', 'éœé¢–æ€¡', 'æ¢å®', 'é™ˆä¿Šå®‰', 'æ¬§æ´é¸¿', 'é™ˆç¿ å©µ', 'è°­çš“å¤©', 'å‘¨ç…œè½©',
            'æç¥–æº', 'å¼ å­å¯…', 'è‘£æ™“', 'è®¸èŠ·è±ª', 'ç¨‹å­¦å€ª', 'å¼ å­æ™´', 'åˆ˜é¢–ä»ª', 'è‹ç°', 'æ›¾åº†èˆª',
            'æ›¾æ˜è½©', 'æ±Ÿæ²©å¥', 'å¼ ä¿Šç„¶', 'é™ˆç»´æ¸', 'é™ˆå®¶ç†™',  'é¾™æƒ æ•', 'é™ˆå‹‡è¾¾', 'æ›¾å¹¸æ–‡', 'é›·æ™ºå®‡',
            'é™ˆå›½ä¼¦', 'é™ˆé¸¿ç®', 'é»„æµ·çª', 'å†¯æŒ¯æ™–', 'é’Ÿä¸šè±ª', 'é™ˆç‚œè£•', 'é™†çƒ¨', 'æ¬§æ¥šæ€¡', 'æ›¾æ¢“å®', 'æ¨é”¦åŸ',
            'è°­ç„¯æ–‡', 'é™ˆå§»å°¹'
        ];
        let originalNames = [];
        let remainingNames = [];
        let intervalId;
        let currentSpeed = 50; // åˆå§‹é€Ÿåº¦ï¼ˆæ¯«ç§’ï¼‰

        // ä½¿ç”¨ sessionStorage ä¿å­˜æ•°æ®ï¼Œä¼šè¯ç»“æŸæ—¶è‡ªåŠ¨æ¸…é™¤
        function loadData() {
            const storedOriginal = sessionStorage.getItem('originalNames');
            const storedRemaining = sessionStorage.getItem('remainingNames');

            if (storedOriginal) {
                originalNames = JSON.parse(storedOriginal);
                remainingNames = storedRemaining ? JSON.parse(storedRemaining) : [...originalNames];
            } else {
                originalNames = [...builtinNames];
                remainingNames = [...originalNames];
                saveData();
            }
            updateDisplay('å‡†å¤‡ä¸­...');
        }

        function saveData() {
            sessionStorage.setItem('originalNames', JSON.stringify(originalNames));
            sessionStorage.setItem('remainingNames', JSON.stringify(remainingNames));
        }

        function updateDisplay(text) {
            document.getElementById('display').textContent = text;
        }

        function getRandomIndex(length) {
            const array = new Uint32Array(1);
            crypto.getRandomValues(array);
            return array[0] % length;
        }

        function startLottery() {
            if (isRunning) return;

            if (remainingNames.length === 0) {
                alert('æ‰€æœ‰åå­—å·²æŠ½å®Œï¼è¯·é‡ç½®ã€‚');
                return;
            }

            document.getElementById('startButton').disabled = true;
            document.getElementById('result').textContent = '';
            isRunning = true;
            currentSpeed = 50;

            // é¢„é€‰æœ€ç»ˆèµ¢å®¶ï¼Œä½¿ç”¨çœŸéšæœº
            const winnerIndex = getRandomIndex(remainingNames.length);
            const winner = remainingNames[winnerIndex];

            // å¼€å§‹å¿«é€Ÿåˆ‡æ¢
            intervalId = setInterval(() => {
                const randomIndex = getRandomIndex(remainingNames.length);
                updateDisplay(remainingNames[randomIndex]);
            }, currentSpeed);

            // é€æ¸å‡é€Ÿ
            let slowdownInterval = setInterval(() => {
                currentSpeed += 50; // æ¯æ¬¡å¢åŠ 50ms
                clearInterval(intervalId);
                if (currentSpeed > 500) {
                    // åœä¸‹æ¥
                    clearInterval(slowdownInterval);
                    updateDisplay(winner);
                    document.getElementById('result').textContent = `ä¸­å¥–è€…ï¼š${winner} ğŸ‰`;
                    // ç§»é™¤æŠ½ä¸­çš„åå­—
                    remainingNames.splice(winnerIndex, 1);
                    saveData();
                    isRunning = false;
                    document.getElementById('startButton').disabled = false;
                } else {
                    // ç»§ç»­åˆ‡æ¢ï¼Œä½†é€Ÿåº¦å˜æ…¢
                    intervalId = setInterval(() => {
                        const randomIndex = getRandomIndex(remainingNames.length);
                        updateDisplay(remainingNames[randomIndex]);
                    }, currentSpeed);
                }
            }, 500); // æ¯ç§’å‡é€Ÿä¸€æ¬¡
        }

        function resetLottery() {
            remainingNames = [...originalNames];
            saveData();
            document.getElementById('result').textContent = '';
            updateDisplay('å‡†å¤‡ä¸­...');
            alert('å·²é‡ç½®ï¼');
        }

        // åŠ è½½æ•°æ®
        loadData();
    </script>
</body>
</html>