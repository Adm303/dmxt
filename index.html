<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>éšæœºåå­—æŠ½å¥–ç³»ç»Ÿï¼ˆæ— é‡å¤ï¼‰</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            text-align: center;
            margin: 50px;
            background-color: #f4f7f9;
            color: #333;
        }
        h1 {
            color: #4a90e2;
            font-size: 2.5em;
            margin-bottom: 20px;
        }
        p {
            font-size: 1.1em;
            margin-bottom: 30px;
            color: #555;
        }
        #display {
            font-size: 48px;
            font-weight: bold;
            color: #e94e77;
            margin: 50px 0;
            height: 60px;
            line-height: 60px;
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
            padding: 20px;
            width: 300px;
            margin: 0 auto 30px;
            transition: color 0.3s;
        }
        button {
            padding: 12px 30px;
            font-size: 18px;
            background-color: #4a90e2;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.2s;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            margin: 10px;
        }
        button:hover {
            background-color: #357abd;
            transform: translateY(-2px);
        }
        button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }
        #result {
            margin-top: 30px;
            font-size: 28px;
            color: #28a745;
            font-weight: bold;
            animation: fadeIn 1s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
    </style>
</head>
<body>
    <h1>éšæœºåå­—æŠ½å¥–ç³»ç»Ÿï¼ˆæ— é‡å¤ï¼‰</h1>
    <p>ç‚¹å‡»å¼€å§‹ï¼Œåå­—ä¼šå¿«é€Ÿéšæœºåˆ‡æ¢ï¼Œç„¶åé€æ¸æ…¢ä¸‹æ¥åœåœ¨å¹¸è¿å„¿ä¸Šã€‚æŠ½ä¸­åç§»é™¤ï¼Œä¸ä¼šé‡å¤ã€‚ç‚¹å‡»é‡ç½®æ¢å¤åŸåˆ—è¡¨ã€‚å…³é—­é¡µé¢åè‡ªåŠ¨é‡ç½®ã€‚ç°åœ¨ä½¿ç”¨çœŸéšæœºï¼Œæ›´å…¬å¹³ï¼</p>
    <button id="startButton" onclick="startLottery()">å¼€å§‹æŠ½å¥–</button>
    <button id="resetButton" onclick="resetLottery()">é‡ç½®</button>
    <div id="display">å‡†å¤‡ä¸­...</div>
    <div id="result"></div>

    <script>
        let isRunning = false;
        const builtinNames = [
            'é™ˆç‚œè£•', 'é’Ÿä¸šè±ª', 'æ›¾å¹¸æ–‡', 'ä½™åº”å³»', 'è‹ç°', 'æ±Ÿèµæ´‹', 'è“æµ·å¹³', 'é»„å®—æ¯…', 'ææ–¹æ™‹', 'é™ˆç»´æ¸',
            'é»„æ¬£å„¿', 'é™ˆå®¶ç†™', 'å‘¨ç…œè½©', 'æç¥–æº', 'æ¨é”¦åŸ', 'é™ˆå›½ä¼¦', 'åˆ˜é¢–ä»ª', 'éœé¢–æ€¡', 'æ¢å®-', 'æ¬§è¯ºç„°',
            'è‘£æ™“-', 'æœ±æ´›è½©', 'è‘£æå®—', 'æ¢ä¸€èŠ¯', 'é¾™æƒ æ•', 'å¼ ä¿Šç„¶', 'å¼ å­æ™´', 'é™ˆä¿Šå®‰', 'æ›¾æ˜è½©', 'æ›¾åº†èˆª',
            'è®¸èŠ·è±ª', 'æ¬§å¿ƒæ€¡', 'å†¯æŒ¯æ™–', 'æ¬§æ¥šæ€¡', 'é»„æµ·çª', 'é™ˆå®¶ä¿Š', 'é™ˆç¿ å©µ', 'é™ˆé¸¿ç®', 'ç¨‹å­¦å€ª', 'æ›¾æ¢“å®',
            'é»æ•ç²', 'æ±Ÿæ²©å¥', 'é™ˆå®¶æ¶›', 'é‚µæ³½æ»”', 'é™ˆå‹‡è¾¾', 'æ¬§æ´é¸¿', 'æ—å®—æ³½', 'ç‹ä»™å', 'é™ˆæ²»å¦', 'é™ˆé’°å©§',
            'è°¢æ²›ä¸š', 'æ¢è‚‡æ¶›', 'è°­çš“å¤©', 'è°­ç„¯æ–‡', 'é™†çƒ¨-', 'é™ˆå§»å°¹', 'é’Ÿæœ‰æ‰¬', 'é›·æ™ºå®‡', 'å¼ å­å¯…', 'é™ˆå­¦æˆ',
            
        ];
        let originalNames = [];
        let remainingNames = [];
        let intervalId;
        let currentSpeed = 20; // åˆå§‹é€Ÿåº¦
        let shuffledList = []; // æ´—ç‰Œåˆ—è¡¨
        let displayIndex = 0; // å½“å‰æ˜¾ç¤ºç´¢å¼•

        // ä½¿ç”¨ sessionStorage ä¿å­˜æ•°æ®ï¼Œä¼šè¯ç»“æŸæ—¶è‡ªåŠ¨æ¸…é™¤
        function loadData() {
            const storedOriginal = sessionStorage.getItem('originalNames');
            const storedRemaining = sessionStorage.getItem('remainingNames');

            if (storedOriginal) {
                originalNames = JSON.parse(storedOriginal);
                remainingNames = storedRemaining ? JSON.parse(storedRemaining) : [...originalNames];
            } else {
                originalNames = [...builtinNames];
                remainingNames = [...originalNames];
                saveData();
            }
            updateDisplay('å‡†å¤‡ä¸­...');
        }

        function saveData() {
            sessionStorage.setItem('originalNames', JSON.stringify(originalNames));
            sessionStorage.setItem('remainingNames', JSON.stringify(remainingNames));
        }

        function updateDisplay(text) {
            document.getElementById('display').textContent = text;
        }

        function getRandomIndex(length) {
            const array = new Uint32Array(1);
            crypto.getRandomValues(array);
            return array[0] % length; // åˆ‡æ¢å›çœŸéšæœº
        }

        // Fisher-Yates shuffle å‡½æ•°
        function shuffle(array) {
            let shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = getRandomIndex(i + 1);
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }

        function startLottery() {
            if (isRunning) return;

            if (remainingNames.length === 0) {
                alert('æ‰€æœ‰åå­—å·²æŠ½å®Œï¼è¯·é‡ç½®ã€‚');
                return;
            }

            document.getElementById('startButton').disabled = true;
            document.getElementById('result').textContent = '';
            isRunning = true;
            currentSpeed = 20;
            displayIndex = 0;

            // é¢„é€‰æœ€ç»ˆèµ¢å®¶
            const winnerIndex = getRandomIndex(remainingNames.length);
            const winner = remainingNames[winnerIndex];

            // æ´—ç‰Œå‰©ä½™åå­—
            shuffledList = shuffle(remainingNames);

            // å¼€å§‹é¡ºåºåˆ‡æ¢æ´—ç‰Œåˆ—è¡¨
            intervalId = setInterval(() => {
                updateDisplay(shuffledList[displayIndex]);
                displayIndex = (displayIndex + 1) % shuffledList.length;
            }, currentSpeed);

            // é€æ¸å‡é€Ÿ
            let slowdownInterval = setInterval(() => {
                currentSpeed += 100;
                clearInterval(intervalId);
                if (currentSpeed > 400) {
                    // åœä¸‹æ¥
                    clearInterval(slowdownInterval);
                    updateDisplay(winner);
                    document.getElementById('result').textContent = `ä¸­å¥–è€…ï¼š${winner} ğŸ‰`;
                    // ç§»é™¤æŠ½ä¸­çš„åå­—
                    remainingNames.splice(remainingNames.indexOf(winner), 1);
                    saveData();
                    isRunning = false;
                    document.getElementById('startButton').disabled = false;
                } else {
                    // ç»§ç»­åˆ‡æ¢ï¼Œä½†é€Ÿåº¦å˜æ…¢
                    intervalId = setInterval(() => {
                        updateDisplay(shuffledList[displayIndex]);
                        displayIndex = (displayIndex + 1) % shuffledList.length;
                    }, currentSpeed);
                }
            }, 500);
        }

        function resetLottery() {
            remainingNames = [...originalNames];
            saveData();
            document.getElementById('result').textContent = '';
            updateDisplay('å‡†å¤‡ä¸­...');
            alert('å·²é‡ç½®ï¼');
        }

        // åŠ è½½æ•°æ®
        loadData();
    </script>
</body>
</html>
